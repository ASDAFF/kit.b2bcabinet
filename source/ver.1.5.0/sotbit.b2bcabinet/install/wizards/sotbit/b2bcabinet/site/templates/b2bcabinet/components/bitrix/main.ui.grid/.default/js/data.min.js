!function(){"use strict";BX.namespace("BX.Grid"),BX.Grid.Data=function(t){this.parent=t,this.reset()},BX.Grid.Data.prototype.reset=function(){this.response=null,this.xhr=null,this.headRows=null,this.bodyRows=null,this.footRows=null,this.moreButton=null,this.pagination=null,this.counterDisplayed=null,this.counterSelected=null,this.counterTotal=null,this.limit=null,this.actionPanel=null,this.rowsByParentId={},this.rowById={},this.isValidResponse=null},BX.Grid.Data.prototype.getParent=function(){return this.parent},BX.Grid.Data.prototype.validateResponse=function(){return BX.type.isBoolean(this.isValidResponse)||(this.isValidResponse=!!this.getResponse()&&!!BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classContainer"),!0)),this.isValidResponse},BX.Grid.Data.prototype.request=function(t,e,s,i,n,r){BX.type.isString(t)||(t=""),BX.type.isNotEmptyString(e)||(e="GET"),BX.type.isPlainObject(s)||(s={});var o={gridId:this.parent.getId(),url:t,method:e,data:s};BX.onCustomEvent(window,"Grid::beforeRequest",[this,o]),t=o.url,BX.type.isNotEmptyString(t)||(t=window.location.pathname+window.location.search),t=BX.Grid.Utils.addUrlParams(t,{sessid:BX.bitrix_sessid(),internal:"true",grid_id:this.parent.getId()}),t="apply_filter"in s&&"Y"===s.apply_filter?BX.Grid.Utils.addUrlParams(t,{apply_filter:"Y"}):BX.util.remove_url_param(t,"apply_filter"),t="clear_nav"in s&&"Y"===s.clear_nav?BX.Grid.Utils.addUrlParams(t,{clear_nav:"Y"}):BX.util.remove_url_param(t,"clear_nav"),t=BX.Grid.Utils.addUrlParams(t,{grid_action:i||"showpage"}),e=o.method,s=o.data,this.reset();var a=this;setTimeout(function(){var o=BX.ajax({url:BX.Grid.Utils.ajaxUrl(t,a.getParent().getAjaxId()),data:s,method:e,dataType:"html",headers:[{name:"X-Ajax-Grid-UID",value:a.getParent().getAjaxId()},{name:"X-Ajax-Grid-Req",value:JSON.stringify({action:i||"showpage"})}],processData:!0,scriptsRunFirst:!1,onsuccess:function(t){a.response=BX.create("div",{html:t}),a.response=a.response.querySelector("#"+a.parent.getContainerId()),a.xhr=o,BX.type.isFunction(n)&&BX.delegate(n,a)(t,o)},onerror:function(t){a.error=r,a.xhr=o,BX.type.isFunction(r)&&BX.delegate(r,a)(o,t)}})},0)},BX.Grid.Data.prototype.getResponse=function(){return this.response},BX.Grid.Data.prototype.getHeadRows=function(){return this.headRows||(this.headRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classHeadRow"))),this.headRows},BX.Grid.Data.prototype.getBodyRows=function(){return this.bodyRows||(this.bodyRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classBodyRow"))),this.bodyRows},BX.Grid.Data.prototype.getRowsByParentId=function(t){return t in this.rowsByParentId||(this.rowsByParentId[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-parent-id="'+t+'"]')),this.rowsByParentId[t]},BX.Grid.Data.prototype.getRowById=function(t){return t in this.rowById||(this.rowById[t]=BX.Grid.Utils.getBySelector(this.getResponse(),"."+this.getParent().settings.get("classBodyRow")+'[data-id="'+t+'"]',!0)),this.rowById[t]},BX.Grid.Data.prototype.getFootRows=function(){return this.footRows||(this.footRows=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classFootRow"))),this.footRows},BX.Grid.Data.prototype.getMoreButton=function(){return this.moreButton||(this.moreButton=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classMoreButton"),!0)),this.moreButton},BX.Grid.Data.prototype.getPagination=function(){return this.pagination||(this.pagination=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPagination"),!0)),this.pagination},BX.Grid.Data.prototype.getCounterDisplayed=function(){return this.counterDisplayed||(this.counterDisplayed=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterDisplayed"),!0)),this.counterDisplayed},BX.Grid.Data.prototype.getCounterSelected=function(){return this.counterSelected||(this.counterSelected=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classCounterSelected"),!0)),this.counterSelected},BX.Grid.Data.prototype.getCounterTotal=function(){if(!BX.type.isDomNode(this.counterTotal)){var t="."+this.getParent().settings.get("classCounterTotal")+" ."+this.getParent().settings.get("classPanelCellContent");this.counterTotal=BX.Grid.Utils.getBySelector(this.getResponse(),t,!0)}return this.counterTotal},BX.Grid.Data.prototype.getLimit=function(){return this.limit||(this.limit=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classPageSize"),!0)),this.limit},BX.Grid.Data.prototype.getPageSize=function(){return this.getLimit()},BX.Grid.Data.prototype.getActionPanel=function(){return this.actionPanel||(this.actionPanel=BX.Grid.Utils.getByClass(this.getResponse(),this.getParent().settings.get("classActionPanel"),!0)),this.actionPanel}}();