!function(t){"use strict";if(!t.JCCatalogElement){var i=function(t){i.superclass.constructor.apply(this,arguments),this.buttonNode=BX.create("SPAN",{props:{className:"btn btn-default btn-buy btn-sm",id:this.id},style:"object"==typeof t.style?t.style:{},text:t.text,events:this.contextEvents}),BX.browser.IsIE()&&this.buttonNode.setAttribute("hideFocus","hidefocus")};BX.extend(i,BX.PopupWindowButton),t.JCCatalogElement=function(t){if(this.productType=0,this.config={useCatalog:!0,showQuantity:!0,showPrice:!0,showAbsent:!0,showOldPrice:!1,showPercent:!1,showSkuProps:!1,showOfferGroup:!1,useCompare:!1,useStickers:!1,useSubscribe:!1,usePopup:!1,useMagnifier:!1,usePriceRanges:!1,basketAction:["BUY"],showClosePopup:!1,templateTheme:"",showSlider:!1,sliderInterval:5e3,useEnhancedEcommerce:!1,dataLayerName:"dataLayer",brandProperty:!1,alt:"",title:"",magnifierZoomPercent:200},this.checkQuantity=!1,this.maxQuantity=0,this.minQuantity=0,this.stepQuantity=1,this.isDblQuantity=!1,this.canBuy=!0,this.isGift=!1,this.canSubscription=!0,this.currentIsSet=!1,this.updateViewedCount=!1,this.currentPriceMode="",this.currentPrices=[],this.currentPriceSelected=0,this.currentQuantityRanges=[],this.currentQuantityRangeSelected=0,this.precision=6,this.precisionFactor=Math.pow(10,this.precision),this.visual={},this.basketMode="",this.product={checkQuantity:!1,maxQuantity:0,stepQuantity:1,startQuantity:1,isDblQuantity:!1,canBuy:!0,canSubscription:!0,name:"",pict:{},id:0,addUrl:"",buyUrl:"",slider:{},sliderCount:0,useSlider:!1,sliderPict:[]},this.mess={},this.basketData={useProps:!1,emptyProps:!1,quantity:"quantity",props:"prop",basketUrl:"",sku_props:"",sku_props_var:"basket_props",add_url:"",buy_url:""},this.compareData={compareUrl:"",compareDeleteUrl:"",comparePath:""},this.defaultPict={preview:null,detail:null},this.offers=[],this.offerNum=0,this.treeProps=[],this.selectedValues={},this.mouseTimer=null,this.isTouchDevice=BX.hasClass(document.documentElement,"bx-touch"),this.touch=null,this.slider={interval:null,progress:null,paused:null,controls:[]},this.quantityDelay=null,this.quantityTimer=null,this.obProduct=null,this.obQuantity=null,this.obQuantityUp=null,this.obQuantityDown=null,this.obPrice={price:null,full:null,discount:null,percent:null,total:null},this.obTree=null,this.obPriceRanges=null,this.obBuyBtn=null,this.obAddToBasketBtn=null,this.obBasketActions=null,this.obNotAvail=null,this.obSubscribe=null,this.obSkuProps=null,this.obMainSkuProps=null,this.obBigSlider=null,this.obMeasure=null,this.obQuantityLimit={all:null,value:null},this.obCompare=null,this.obTabsPanel=null,this.node={},this.smallCardNodes={},this.magnify={enabled:!1,obBigImg:null,obBigSlider:null,height:0,width:0,timer:0},this.currentImg={id:0,src:"",width:0,height:0},this.viewedCounter={path:"/bitrix/components/bitrix/catalog.element/ajax.php",params:{AJAX:"Y",SITE_ID:"",PRODUCT_ID:0,PARENT_ID:0}},this.obPopupWin=null,this.basketUrl="",this.basketParams={},this.errorCode=0,"object"==typeof t){switch(this.params=t,this.initConfig(),this.params.MESS&&(this.mess=this.params.MESS),this.productType){case 0:case 1:case 2:this.initProductData();break;case 3:this.initOffersData();break;default:this.errorCode=-1}this.initBasketData(),this.initCompareData()}0===this.errorCode&&BX.ready(BX.delegate(this.init,this)),this.params={},BX.addCustomEvent("onSaleProductIsGift",BX.delegate(this.onSaleProductIsGift,this)),BX.addCustomEvent("onSaleProductIsNotGift",BX.delegate(this.onSaleProductIsNotGift,this))},t.JCCatalogElement.prototype={getEntity:function(t,i,s){return t&&i?(s=s||"",t.querySelector(s+'[data-entity="'+i+'"]')):null},getEntities:function(t,i,s){return t&&i?(s=s||"",t.querySelectorAll(s+'[data-entity="'+i+'"]')):{length:0}},onSaleProductIsGift:function(t,i){i&&this.offers&&this.offers[this.offerNum].ID==i&&this.setGift()},onSaleProductIsNotGift:function(t,i){i&&this.offers&&this.offers[this.offerNum].ID==i&&(this.restoreSticker(),this.isGift=!1,this.setPrice())},reloadGiftInfo:function(){3===this.productType&&(this.checkQuantity=!0,this.maxQuantity=1,this.setPrice(),this.redrawSticker({text:BX.message("PRODUCT_GIFT_LABEL")}))},setGift:function(){3===this.productType&&(this.isGift=!0),1!==this.productType&&2!==this.productType||(this.isGift=!0),0===this.productType&&(this.isGift=!1),this.reloadGiftInfo()},setOffer:function(t){this.offerNum=parseInt(t),this.setCurrent()},init:function(){var i=0,s=0,e=null;if(this.obProduct=BX(this.visual.ID),this.obProduct||(this.errorCode=-1),this.obBigSlider=BX(this.visual.BIG_SLIDER_ID),this.node.imageContainer=this.getEntity(this.obProduct,"images-container"),this.node.imageSliderBlock=this.getEntity(this.obProduct,"images-slider-block"),this.node.sliderProgressBar=this.getEntity(this.obProduct,"slider-progress-bar"),this.node.sliderControlLeft=this.getEntity(this.obBigSlider,"slider-control-left"),this.node.sliderControlRight=this.getEntity(this.obBigSlider,"slider-control-right"),this.obBigSlider&&this.node.imageContainer&&this.node.imageContainer||(this.errorCode=-2),this.config.showPrice&&(this.obPrice.price=BX(this.visual.PRICE_ID),!this.obPrice.price&&this.config.useCatalog?this.errorCode=-16:(this.obPrice.total=BX(this.visual.PRICE_TOTAL),this.config.showOldPrice&&(this.obPrice.full=BX(this.visual.OLD_PRICE_ID),this.obPrice.discount=BX(this.visual.DISCOUNT_PRICE_ID),this.obPrice.full&&this.obPrice.discount||(this.config.showOldPrice=!1)),this.config.showPercent&&(this.obPrice.percent=BX(this.visual.DISCOUNT_PERCENT_ID),this.obPrice.percent||(this.config.showPercent=!1))),this.obBasketActions=BX(this.visual.BASKET_ACTIONS_ID),this.obBasketActions&&(BX.util.in_array("BUY",this.config.basketAction)&&(this.obBuyBtn=BX(this.visual.BUY_LINK)),BX.util.in_array("ADD",this.config.basketAction)&&(this.obAddToBasketBtn=BX(this.visual.ADD_BASKET_LINK))),this.obNotAvail=BX(this.visual.NOT_AVAILABLE_MESS)),this.config.showQuantity&&(this.obQuantity=BX(this.visual.QUANTITY_ID),this.node.quantity=this.getEntity(this.obProduct,"quantity-block"),this.visual.QUANTITY_UP_ID&&(this.obQuantityUp=BX(this.visual.QUANTITY_UP_ID)),this.visual.QUANTITY_DOWN_ID&&(this.obQuantityDown=BX(this.visual.QUANTITY_DOWN_ID))),3===this.productType&&(this.visual.TREE_ID&&(this.obTree=BX(this.visual.TREE_ID),this.obTree||(this.errorCode=-256)),this.visual.QUANTITY_MEASURE&&(this.obMeasure=BX(this.visual.QUANTITY_MEASURE)),this.visual.QUANTITY_LIMIT&&"N"!==this.config.showMaxQuantity&&(this.obQuantityLimit.all=BX(this.visual.QUANTITY_LIMIT),this.obQuantityLimit.all&&(this.obQuantityLimit.value=this.getEntity(this.obQuantityLimit.all,"quantity-limit-value"),this.obQuantityLimit.value||(this.obQuantityLimit.all=null))),this.config.usePriceRanges&&(this.obPriceRanges=this.getEntity(this.obProduct,"price-ranges-block"))),this.config.showSkuProps&&(this.obSkuProps=BX(this.visual.DISPLAY_PROP_DIV),this.obMainSkuProps=BX(this.visual.DISPLAY_MAIN_PROP_DIV)),this.config.useCompare&&(this.obCompare=BX(this.visual.COMPARE_LINK)),this.config.useSubscribe&&(this.obSubscribe=BX(this.visual.SUBSCRIBE_LINK)),this.obTabs=BX(this.visual.TABS_ID),this.obTabContainers=BX(this.visual.TAB_CONTAINERS_ID),this.obTabsPanel=BX(this.visual.TABS_PANEL_ID),this.smallCardNodes.panel=BX(this.visual.SMALL_CARD_PANEL_ID),this.smallCardNodes.panel&&(this.smallCardNodes.picture=this.getEntity(this.smallCardNodes.panel,"panel-picture"),this.smallCardNodes.title=this.getEntity(this.smallCardNodes.panel,"panel-title"),this.smallCardNodes.price=this.getEntity(this.smallCardNodes.panel,"panel-price"),this.smallCardNodes.sku=this.getEntity(this.smallCardNodes.panel,"panel-sku-container"),this.smallCardNodes.oldPrice=this.getEntity(this.smallCardNodes.panel,"panel-old-price"),this.smallCardNodes.buyButton=this.getEntity(this.smallCardNodes.panel,"panel-buy-button"),this.smallCardNodes.addButton=this.getEntity(this.smallCardNodes.panel,"panel-add-button"),this.smallCardNodes.notAvailableButton=this.getEntity(this.smallCardNodes.panel,"panel-not-available-button"),this.smallCardNodes.aligner=this.getEntity(this.obProduct,"main-button-container")),this.initPopup(),this.initTabs(),this.smallCardNodes.panel&&(this.smallCardNodes.picture&&BX.bind(this.smallCardNodes.picture.parentNode,"click",BX.proxy(this.scrollToProduct,this)),this.smallCardNodes.title&&BX.bind(this.smallCardNodes.title,"click",BX.proxy(this.scrollToProduct,this)),this.smallCardNodes.sku&&BX.bind(this.smallCardNodes.sku,"click",BX.proxy(this.scrollToProduct,this))),(this.obTabsPanel||this.smallCardNodes.panel)&&(this.checkTopPanels(),BX.bind(t,"scroll",BX.proxy(this.checkTopPanels,this))),0===this.errorCode){if(this.config.showSlider&&!this.isTouchDevice&&(BX.bind(this.obBigSlider,"mouseenter",BX.proxy(this.stopSlider,this)),BX.bind(this.obBigSlider,"mouseleave",BX.proxy(this.cycleSlider,this))),this.isTouchDevice&&(BX.bind(this.node.imageContainer,"touchstart",BX.proxy(this.touchStartEvent,this)),BX.bind(this.node.imageContainer,"touchend",BX.proxy(this.touchEndEvent,this)),BX.bind(this.node.imageContainer,"touchcancel",BX.proxy(this.touchEndEvent,this))),BX.bind(this.node.sliderControlLeft,"click",BX.proxy(this.slidePrev,this)),BX.bind(this.node.sliderControlRight,"click",BX.proxy(this.slideNext,this)),this.config.showQuantity){var a=this.isTouchDevice?"touchstart":"mousedown",r=this.isTouchDevice?"touchend":"mouseup";this.obQuantityUp&&(BX.bind(this.obQuantityUp,a,BX.proxy(this.startQuantityInterval,this)),BX.bind(this.obQuantityUp,r,BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityUp,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityUp,"click",BX.delegate(this.quantityUp,this))),this.obQuantityDown&&(BX.bind(this.obQuantityDown,a,BX.proxy(this.startQuantityInterval,this)),BX.bind(this.obQuantityDown,r,BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityDown,"mouseout",BX.proxy(this.clearQuantityInterval,this)),BX.bind(this.obQuantityDown,"click",BX.delegate(this.quantityDown,this))),this.obQuantity&&BX.bind(this.obQuantity,"change",BX.delegate(this.quantityChange,this))}switch(this.productType){case 0:case 1:case 2:if(this.product.useSlider){for(this.product.slider={ID:this.visual.SLIDER_CONT_ID,CONT:BX(this.visual.SLIDER_CONT_ID),COUNT:this.product.sliderCount},this.product.slider.ITEMS=this.getEntities(this.product.slider.CONT,"slider-control"),s=0;s<this.product.slider.ITEMS.length;s++)BX.bind(this.product.slider.ITEMS[s],"mouseenter",BX.delegate(this.onSliderControlHover,this)),BX.bind(this.product.slider.ITEMS[s],"mouseleave",BX.delegate(this.onSliderControlLeave,this)),BX.bind(this.product.slider.ITEMS[s],"click",BX.delegate(this.selectSliderImg,this));this.setCurrentImg(this.product.sliderPict[0],!0,!0),this.checkSliderControls(this.product.sliderCount),this.product.slider.ITEMS.length>1&&this.initSlider()}this.checkQuantityControls(),this.fixFontCheck(),this.setAnalyticsDataLayer("showDetail");break;case 3:for(e=this.obTree.querySelectorAll("li"),i=0;i<e.length;i++)BX.bind(e[i],"click",BX.delegate(this.selectOfferProp,this));for(i=0;i<this.offers.length;i++)if(this.offers[i].SLIDER_COUNT=parseInt(this.offers[i].SLIDER_COUNT,10)||0,0===this.offers[i].SLIDER_COUNT)this.slider.controls[i]={ID:"",COUNT:this.offers[i].SLIDER_COUNT,ITEMS:[]};else{for(s=0;s<this.offers[i].SLIDER.length;s++)this.offers[i].SLIDER[s].WIDTH=parseInt(this.offers[i].SLIDER[s].WIDTH,10),this.offers[i].SLIDER[s].HEIGHT=parseInt(this.offers[i].SLIDER[s].HEIGHT,10);for(this.slider.controls[i]={ID:this.visual.SLIDER_CONT_OF_ID+this.offers[i].ID,OFFER_ID:this.offers[i].ID,CONT:BX(this.visual.SLIDER_CONT_OF_ID+this.offers[i].ID),COUNT:this.offers[i].SLIDER_COUNT},this.slider.controls[i].ITEMS=this.getEntities(this.slider.controls[i].CONT,"slider-control"),s=0;s<this.slider.controls[i].ITEMS.length;s++)BX.bind(this.slider.controls[i].ITEMS[s],"mouseenter",BX.delegate(this.onSliderControlHover,this)),BX.bind(this.slider.controls[i].ITEMS[s],"mouseleave",BX.delegate(this.onSliderControlLeave,this)),BX.bind(this.slider.controls[i].ITEMS[s],"click",BX.delegate(this.selectSliderImg,this))}this.setCurrent()}this.obBuyBtn&&BX.bind(this.obBuyBtn,"click",BX.proxy(this.buyBasket,this)),this.smallCardNodes.buyButton&&BX.bind(this.smallCardNodes.buyButton,"click",BX.proxy(this.buyBasket,this)),this.obAddToBasketBtn&&BX.bind(this.obAddToBasketBtn,"click",BX.proxy(this.add2Basket,this)),this.smallCardNodes.addButton&&BX.bind(this.smallCardNodes.addButton,"click",BX.proxy(this.add2Basket,this)),this.obCompare&&(BX.bind(this.obCompare,"click",BX.proxy(this.compare,this)),BX.addCustomEvent("onCatalogDeleteCompare",BX.proxy(this.checkDeletedCompare,this)))}},initConfig:function(){this.params.PRODUCT_TYPE&&(this.productType=parseInt(this.params.PRODUCT_TYPE,10)),"undefined"!==this.params.CONFIG.USE_CATALOG&&BX.type.isBoolean(this.params.CONFIG.USE_CATALOG)&&(this.config.useCatalog=this.params.CONFIG.USE_CATALOG),this.config.showQuantity=this.params.CONFIG.SHOW_QUANTITY,this.config.showPrice=this.params.CONFIG.SHOW_PRICE,this.config.showPercent=this.params.CONFIG.SHOW_DISCOUNT_PERCENT,this.config.showOldPrice=this.params.CONFIG.SHOW_OLD_PRICE,this.config.showSkuProps=this.params.CONFIG.SHOW_SKU_PROPS,this.config.showOfferGroup=this.params.CONFIG.OFFER_GROUP,this.config.useCompare=this.params.CONFIG.DISPLAY_COMPARE,this.config.useStickers=this.params.CONFIG.USE_STICKERS,this.config.useSubscribe=this.params.CONFIG.USE_SUBSCRIBE,this.config.showMaxQuantity=this.params.CONFIG.SHOW_MAX_QUANTITY,this.config.relativeQuantityFactor=parseInt(this.params.CONFIG.RELATIVE_QUANTITY_FACTOR),this.config.usePriceRanges=this.params.CONFIG.USE_PRICE_COUNT,this.params.CONFIG.MAIN_PICTURE_MODE&&(this.config.usePopup=BX.util.in_array("POPUP",this.params.CONFIG.MAIN_PICTURE_MODE),this.config.useMagnifier=BX.util.in_array("MAGNIFIER",this.params.CONFIG.MAIN_PICTURE_MODE)),this.params.CONFIG.ADD_TO_BASKET_ACTION&&(this.config.basketAction=this.params.CONFIG.ADD_TO_BASKET_ACTION),this.config.showClosePopup=this.params.CONFIG.SHOW_CLOSE_POPUP,this.config.templateTheme=this.params.CONFIG.TEMPLATE_THEME||"",this.config.showSlider="Y"===this.params.CONFIG.SHOW_SLIDER,this.config.showSlider&&!this.isTouchDevice?this.config.sliderInterval=parseInt(this.params.CONFIG.SLIDER_INTERVAL)||5e3:this.config.sliderInterval=!1,this.config.useEnhancedEcommerce="Y"===this.params.CONFIG.USE_ENHANCED_ECOMMERCE,this.config.dataLayerName=this.params.CONFIG.DATA_LAYER_NAME,this.config.brandProperty=this.params.CONFIG.BRAND_PROPERTY,this.config.alt=this.params.CONFIG.ALT||"",this.config.title=this.params.CONFIG.TITLE||"",this.config.magnifierZoomPercent=parseInt(this.params.CONFIG.MAGNIFIER_ZOOM_PERCENT)||200,this.params.VISUAL&&"object"==typeof this.params.VISUAL&&this.params.VISUAL.ID?this.visual=this.params.VISUAL:this.errorCode=-1},initProductData:function(){var t=0;if(this.params.PRODUCT&&"object"==typeof this.params.PRODUCT){if(this.config.showQuantity&&(this.product.checkQuantity=this.params.PRODUCT.CHECK_QUANTITY,this.product.isDblQuantity=this.params.PRODUCT.QUANTITY_FLOAT,this.config.showPrice&&(this.currentPriceMode=this.params.PRODUCT.ITEM_PRICE_MODE,this.currentPrices=this.params.PRODUCT.ITEM_PRICES,this.currentPriceSelected=this.params.PRODUCT.ITEM_PRICE_SELECTED,this.currentQuantityRanges=this.params.PRODUCT.ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=this.params.PRODUCT.ITEM_QUANTITY_RANGE_SELECTED),this.product.checkQuantity&&(this.product.maxQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.MAX_QUANTITY):parseInt(this.params.PRODUCT.MAX_QUANTITY,10)),this.product.stepQuantity=this.product.isDblQuantity?parseFloat(this.params.PRODUCT.STEP_QUANTITY):parseInt(this.params.PRODUCT.STEP_QUANTITY,10),this.checkQuantity=this.product.checkQuantity,this.isDblQuantity=this.product.isDblQuantity,this.stepQuantity=this.product.stepQuantity,this.maxQuantity=this.product.maxQuantity,this.minQuantity="Q"===this.currentPriceMode?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity,this.isDblQuantity&&(this.stepQuantity=Math.round(this.stepQuantity*this.precisionFactor)/this.precisionFactor)),this.product.canBuy=this.params.PRODUCT.CAN_BUY,this.canSubscription=this.product.canSubscription=this.params.PRODUCT.SUBSCRIPTION,this.product.name=this.params.PRODUCT.NAME,this.product.pict=this.params.PRODUCT.PICT,this.product.id=this.params.PRODUCT.ID,this.product.category=this.params.PRODUCT.CATEGORY,this.params.PRODUCT.ADD_URL&&(this.product.addUrl=this.params.PRODUCT.ADD_URL),this.params.PRODUCT.BUY_URL&&(this.product.buyUrl=this.params.PRODUCT.BUY_URL),this.params.PRODUCT.SLIDER_COUNT&&(this.product.sliderCount=parseInt(this.params.PRODUCT.SLIDER_COUNT,10)||0,this.product.sliderCount>0&&this.params.PRODUCT.SLIDER.length)){for(t=0;t<this.params.PRODUCT.SLIDER.length;t++)this.product.useSlider=!0,this.params.PRODUCT.SLIDER[t].WIDTH=parseInt(this.params.PRODUCT.SLIDER[t].WIDTH,10),this.params.PRODUCT.SLIDER[t].HEIGHT=parseInt(this.params.PRODUCT.SLIDER[t].HEIGHT,10);this.product.sliderPict=this.params.PRODUCT.SLIDER,this.setCurrentImg(this.product.sliderPict[0],!1)}this.currentIsSet=!0}else this.errorCode=-1},initOffersData:function(){this.params.OFFERS&&BX.type.isArray(this.params.OFFERS)?(this.offers=this.params.OFFERS,this.offerNum=0,this.params.OFFER_SELECTED&&(this.offerNum=parseInt(this.params.OFFER_SELECTED,10)||0),this.params.TREE_PROPS&&(this.treeProps=this.params.TREE_PROPS),this.params.DEFAULT_PICTURE&&(this.defaultPict.preview=this.params.DEFAULT_PICTURE.PREVIEW_PICTURE,this.defaultPict.detail=this.params.DEFAULT_PICTURE.DETAIL_PICTURE),this.params.PRODUCT&&"object"==typeof this.params.PRODUCT&&(this.product.id=parseInt(this.params.PRODUCT.ID,10),this.product.name=this.params.PRODUCT.NAME,this.product.category=this.params.PRODUCT.CATEGORY)):this.errorCode=-1},initBasketData:function(){this.params.BASKET&&"object"==typeof this.params.BASKET&&(1!==this.productType&&2!==this.productType||(this.basketData.useProps=this.params.BASKET.ADD_PROPS,this.basketData.emptyProps=this.params.BASKET.EMPTY_PROPS),this.params.BASKET.QUANTITY&&(this.basketData.quantity=this.params.BASKET.QUANTITY),this.params.BASKET.PROPS&&(this.basketData.props=this.params.BASKET.PROPS),this.params.BASKET.BASKET_URL&&(this.basketData.basketUrl=this.params.BASKET.BASKET_URL),3===this.productType&&this.params.BASKET.SKU_PROPS&&(this.basketData.sku_props=this.params.BASKET.SKU_PROPS),this.params.BASKET.ADD_URL_TEMPLATE&&(this.basketData.add_url=this.params.BASKET.ADD_URL_TEMPLATE),this.params.BASKET.BUY_URL_TEMPLATE&&(this.basketData.buy_url=this.params.BASKET.BUY_URL_TEMPLATE),""===this.basketData.add_url&&""===this.basketData.buy_url&&(this.errorCode=-1024))},initCompareData:function(){this.config.useCompare&&(this.params.COMPARE&&"object"==typeof this.params.COMPARE?(this.params.COMPARE.COMPARE_PATH&&(this.compareData.comparePath=this.params.COMPARE.COMPARE_PATH),this.params.COMPARE.COMPARE_URL_TEMPLATE?this.compareData.compareUrl=this.params.COMPARE.COMPARE_URL_TEMPLATE:this.config.useCompare=!1,this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE?this.compareData.compareDeleteUrl=this.params.COMPARE.COMPARE_DELETE_URL_TEMPLATE:this.config.useCompare=!1):this.config.useCompare=!1)},initSlider:function(){this.node.sliderProgressBar&&(this.slider.progress?this.resetProgress():this.slider.progress=new BX.easing({transition:BX.easing.transitions.linear,step:BX.delegate(function(t){this.node.sliderProgressBar.style.width=t.width/10+"%"},this)})),this.cycleSlider()},setAnalyticsDataLayer:function(i){if(this.config.useEnhancedEcommerce&&this.config.dataLayerName){var s,e,a,r,o,n,h={},l={},c=[];switch(this.productType){case 0:case 1:case 2:h={id:this.product.id,name:this.product.name,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty};break;case 3:for(s in this.offers[this.offerNum].TREE)if(this.offers[this.offerNum].TREE.hasOwnProperty(s))for(e in r=s.substring(5),o=this.offers[this.offerNum].TREE[s],this.treeProps)if(this.treeProps.hasOwnProperty(e)&&this.treeProps[e].ID==r)for(a in this.treeProps[e].VALUES)if((n=this.treeProps[e].VALUES[a]).ID==o){c.push(n.NAME);break}h={id:this.offers[this.offerNum].ID,name:this.offers[this.offerNum].NAME,price:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].PRICE,category:this.product.category,brand:BX.type.isArray(this.config.brandProperty)?this.config.brandProperty.join("/"):this.config.brandProperty,variant:c.join("/")}}switch(i){case"showDetail":l={event:"showDetail",ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",detail:{products:[{name:h.name||"",id:h.id||"",price:h.price||0,brand:h.brand||"",category:h.category||"",variant:h.variant||""}]}}};break;case"addToCart":l={event:"addToCart",ecommerce:{currencyCode:this.currentPrices[this.currentPriceSelected]&&this.currentPrices[this.currentPriceSelected].CURRENCY||"",add:{products:[{name:h.name||"",id:h.id||"",price:h.price||0,brand:h.brand||"",category:h.category||"",variant:h.variant||"",quantity:this.config.showQuantity&&this.obQuantity?this.obQuantity.value:1}]}}}}t[this.config.dataLayerName]=t[this.config.dataLayerName]||[],t[this.config.dataLayerName].push(l)}},initTabs:function(){var t,i,s=this.getEntities(this.obTabs,"tab"),e=this.getEntities(this.obTabsPanel,"tab"),a=!1;if(s.length===e.length)for(var r in s)s.hasOwnProperty(r)&&BX.type.isDomNode(s[r])&&(t=s[r].getAttribute("data-value"))&&(i=this.obTabContainers.querySelector('[data-value="'+t+'"]'),BX.type.isDomNode(i)&&(BX.bind(s[r],"click",BX.proxy(this.changeTab,this)),BX.bind(e[r],"click",BX.proxy(this.changeTab,this)),a?(BX.removeClass(s[r],"active"),BX.removeClass(e[r],"active"),BX.hide(i)):(BX.addClass(s[r],"active"),BX.addClass(e[r],"active"),BX.show(i),a=!0)))},checkTouch:function(t){return!(!t||!t.changedTouches)&&t.changedTouches[0].identifier===this.touch.identifier},touchStartEvent:function(t){1==t.touches.length&&(this.touch=t.changedTouches[0])},touchEndEvent:function(t){if(this.checkTouch(t)){var i=this.touch.pageX-t.changedTouches[0].pageX,s=this.touch.pageY-t.changedTouches[0].pageY;Math.abs(i)>=Math.abs(s)+10&&(i>0&&this.slideNext(),i<0&&this.slidePrev())}},cycleSlider:function(t){if(t||(this.slider.paused=!1),this.slider.interval&&clearInterval(this.slider.interval),this.config.sliderInterval&&!this.slider.paused)if(this.slider.progress){this.slider.progress.stop();var i=parseInt(this.node.sliderProgressBar.style.width);this.slider.progress.options.duration=this.config.sliderInterval*(100-i)/100,this.slider.progress.options.start={width:10*i},this.slider.progress.options.finish={width:1e3},this.slider.progress.options.complete=BX.delegate(function(){this.slider.interval=!0,this.slideNext()},this),this.slider.progress.animate()}else this.slider.interval=setInterval(BX.proxy(this.slideNext,this),this.config.sliderInterval)},stopSlider:function(t){if(t||(this.slider.paused=!0),this.slider.interval&&(this.slider.interval=clearInterval(this.slider.interval)),this.slider.progress){this.slider.progress.stop();var i=parseInt(this.node.sliderProgressBar.style.width);this.slider.progress.options.duration=this.config.sliderInterval*i/200,this.slider.progress.options.start={width:10*i},this.slider.progress.options.finish={width:0},this.slider.progress.options.complete=null,this.slider.progress.animate()}},resetProgress:function(){this.slider.progress&&this.slider.progress.stop(),this.node.sliderProgressBar.style.width=0},slideNext:function(){return this.slide("next")},slidePrev:function(){return this.slide("prev")},slide:function(t){if(this.product.slider&&this.product.slider.CONT){var i=this.getEntity(this.product.slider.CONT,"slider-control",".active"),s=this.getItemForDirection(t,i);BX.removeClass(i,"active"),this.selectSliderImg(s),this.slider.interval&&this.cycleSlider()}},getItemForDirection:function(t,i){var s=(this.getItemIndex(i)+("prev"===t?-1:1))%this.product.slider.COUNT;return this.eq(this.product.slider.ITEMS,s)},getItemIndex:function(t){return BX.util.array_values(this.product.slider.ITEMS).indexOf(t)},eq:function(t,i){var s=t.length,e=+i+(i<0?s:0);return e>=0&&e<s?t[e]:{}},scrollToProduct:function(){var i=BX.GetWindowScrollPos().scrollTop,s=BX.pos(this.obProduct).top-30;i>s&&new BX.easing({duration:500,start:{scroll:i},finish:{scroll:s},transition:BX.easing.makeEaseOut(BX.easing.transitions.quint),step:BX.delegate(function(i){t.scrollTo(0,i.scroll)},this)}).animate()},checkTopPanels:function(){var t=BX.GetWindowScrollPos().scrollTop;this.smallCardNodes.panel&&(t>BX.pos(this.smallCardNodes.aligner).bottom-50?BX.addClass(this.smallCardNodes.panel,"active"):BX.hasClass(this.smallCardNodes.panel,"active")&&BX.removeClass(this.smallCardNodes.panel,"active")),this.obTabsPanel&&(t+73>BX.pos(this.obTabs).top?BX.addClass(this.obTabsPanel,"active"):BX.hasClass(this.obTabsPanel,"active")&&BX.removeClass(this.obTabsPanel,"active"))},changeTab:function(i){BX.PreventDefault(i);var s,e,a,r=BX.proxy_context&&BX.proxy_context.getAttribute("data-value");if(!BX.hasClass(BX.proxy_context,"active")&&r){for(var o in s=this.getEntities(this.obTabContainers,"tab-container"))s.hasOwnProperty(o)&&BX.type.isDomNode(s[o])&&(s[o].getAttribute("data-value")===r?BX.show(s[o]):BX.hide(s[o]));for(o in e=this.getEntities(this.obTabs,"tab"),a=this.getEntities(this.obTabsPanel,"tab"),e)e.hasOwnProperty(o)&&BX.type.isDomNode(e[o])&&(e[o].getAttribute("data-value")===r?(BX.addClass(e[o],"active"),BX.addClass(a[o],"active")):(BX.removeClass(e[o],"active"),BX.removeClass(a[o],"active")))}var n=BX.GetWindowScrollPos().scrollTop,h=BX.pos(this.obTabContainers).top;n+150>h&&new BX.easing({duration:500,start:{scroll:n},finish:{scroll:h-150},transition:BX.easing.makeEaseOut(BX.easing.transitions.quint),step:BX.delegate(function(i){t.scrollTo(0,i.scroll)},this)}).animate()},initPopup:function(){this.config.usePopup&&(this.node.imageContainer.style.cursor="zoom-in",BX.bind(this.node.imageContainer,"click",BX.delegate(this.toggleMainPictPopup,this)),BX.bind(document,"keyup",BX.proxy(this.closeByEscape,this)),BX.bind(this.getEntity(this.obBigSlider,"close-popup"),"click",BX.proxy(this.hideMainPictPopup,this)))},checkSliderControls:function(t){var i=t>1?"":"none";this.node.sliderControlLeft&&(this.node.sliderControlLeft.style.display=i),this.node.sliderControlRight&&(this.node.sliderControlRight.style.display=i)},setCurrentImg:function(t,i,s){var e,a;if(this.currentImg.id=t.ID,this.currentImg.src=t.SRC,this.currentImg.width=t.WIDTH,this.currentImg.height=t.HEIGHT,i&&this.node.imageContainer)for(a=(e=this.getEntities(this.node.imageContainer,"image")).length;a--;)e[a].getAttribute("data-id")==t.ID?(BX.hasClass(e[a],"active")||this.node.sliderProgressBar&&this.resetProgress(),BX.addClass(e[a],"active")):BX.hasClass(e[a],"active")&&BX.removeClass(e[a],"active");s&&this.smallCardNodes.picture&&this.smallCardNodes.picture.setAttribute("src",this.currentImg.src),this.config.useMagnifier&&!this.isTouchDevice&&(this.setMagnifierParams(),i&&this.disableMagnifier(!0))},setMagnifierParams:function(){for(var t,i=this.getEntities(this.node.imageContainer,"image"),s=i.length;s--;)(t=i[s].querySelector("img")).setAttribute("data-title",t.getAttribute("title")||""),t.removeAttribute("title"),i[s].getAttribute("data-id")==this.currentImg.id&&(BX.unbind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this)),this.currentImg.node=t,this.currentImg.node.style.backgroundImage="url('"+this.currentImg.src+"')",this.currentImg.node.style.backgroundSize="100% auto",BX.bind(this.currentImg.node,"mouseover",BX.proxy(this.enableMagnifier,this)))},enableMagnifier:function(){BX.bind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this))},disableMagnifier:function(t){this.magnify.enabled&&(clearTimeout(this.magnify.timer),BX.removeClass(this.obBigSlider,"magnified"),this.magnify.enabled=!1,this.currentImg.node.style.backgroundSize="100% auto",t?(this.currentImg.node.style.height=this.magnify.height+"px",this.currentImg.node.style.width=this.magnify.width+"px",this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.src=this.currentImg.src,this.currentImg.node.style.height="",this.currentImg.node.style.width=""},this),250)):(this.currentImg.node.src=this.currentImg.src,this.currentImg.node.style.height="",this.currentImg.node.style.width=""),BX.unbind(document,"mousemove",BX.proxy(this.moveMagnifierArea,this)))},moveMagnifierArea:function(t){var i=BX.pos(this.currentImg.node),s=this.inRect(t,i);if(this.inBound(i,s)){var e,a,r,o,n,h=s.X/this.currentImg.node.width*100,l=s.Y/this.currentImg.node.height*100;this.currentImg.node.style.backgroundPosition=h+"% "+l+"%",this.magnify.enabled||(clearTimeout(this.magnify.timer),BX.addClass(this.obBigSlider,"magnified"),this.currentImg.node.style.height=(this.magnify.height=this.currentImg.node.clientHeight)+"px",this.currentImg.node.style.width=(this.magnify.width=this.currentImg.node.offsetWidth)+"px",e=this.currentImg.width/this.currentImg.height,(a=this.obBigSlider.offsetWidth)>this.currentImg.width&&!BX.hasClass(this.obBigSlider,"popup")?(o=(r=a)/e,n=100):(r=this.currentImg.width,o=this.currentImg.height,n=this.config.magnifierZoomPercent>100?this.config.magnifierZoomPercent:100),this.currentImg.node.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12P4zwAAAgEBAKrChTYAAAAASUVORK5CYII=",this.currentImg.node.style.backgroundSize=n+"% auto",this.magnify.timer=setTimeout(BX.delegate(function(){this.currentImg.node.style.height=o+"px",this.currentImg.node.style.width=r+"px"},this),10)),this.magnify.enabled=!0}else this.disableMagnifier(!0)},inBound:function(t,i){return i.Y>=0&&t.height>=i.Y&&i.X>=0&&t.width>=i.X},inRect:function(t,i){var s=BX.GetWindowSize(),e={X:0,Y:0,globalX:0,globalY:0};return e.globalX=t.clientX+s.scrollLeft,t.offsetX&&t.offsetX<0&&(e.globalX-=t.offsetX),e.X=e.globalX-i.left,e.globalY=t.clientY+s.scrollTop,t.offsetY&&t.offsetY<0&&(e.globalY-=t.offsetY),e.Y=e.globalY-i.top,e},setProductMainPict:function(t){var i=-1,s=0,e=0;if(this.product.sliderCount){for(e=0;e<this.product.sliderPict.length;e++)if(t===this.product.sliderPict[e].ID){i=e;break}if(i>-1)for(this.product.sliderPict[i]&&this.setCurrentImg(this.product.sliderPict[i],!0),s=0;s<this.product.slider.ITEMS.length;s++)this.product.slider.ITEMS[s].getAttribute("data-value")===t?BX.addClass(this.product.slider.ITEMS[s],"active"):BX.hasClass(this.product.slider.ITEMS[s],"active")&&BX.removeClass(this.product.slider.ITEMS[s],"active")}},onSliderControlHover:function(){var t=BX.proxy_context;this.mouseTimer=setTimeout(BX.delegate(function(){this.selectSliderImg(t)},this),200)},onSliderControlLeave:function(){clearTimeout(this.mouseTimer),this.mouseTimer=null},selectSliderImg:function(t){var i="",s=[];(t=BX.type.isDomNode(t)?t:BX.proxy_context)&&t.hasAttribute("data-value")&&(-1!==(i=t.getAttribute("data-value")).indexOf("_")?(s=i.split("_"),this.setMainPict(s[0],s[1])):this.setProductMainPict(i))},setMainPict:function(t,i,s){var e,a,r=-1,o=-1,n="";for(e=0;e<this.offers.length;e++)if(t===this.offers[e].ID){r=e;break}if(r>-1&&this.offers[r].SLIDER_COUNT>0){for(a=0;a<this.offers[r].SLIDER.length;a++)if(i===this.offers[r].SLIDER[a].ID){o=a;break}if(o>-1)for(this.offers[r].SLIDER[o]&&this.setCurrentImg(this.offers[r].SLIDER[o],!0,s),n=t+"_"+i,e=0;e<this.product.slider.ITEMS.length;e++)this.product.slider.ITEMS[e].getAttribute("data-value")===n?BX.addClass(this.product.slider.ITEMS[e],"active"):BX.hasClass(this.product.slider.ITEMS[e],"active")&&BX.removeClass(this.product.slider.ITEMS[e],"active")}},setMainPictFromItem:function(t){if(this.node.imageContainer){var i=!1,s={};this.offers[t]&&(this.offers[t].DETAIL_PICTURE?(s=this.offers[t].DETAIL_PICTURE,i=!0):this.offers[t].PREVIEW_PICTURE&&(s=this.offers[t].PREVIEW_PICTURE,i=!0)),i||(this.defaultPict.detail?(s=this.defaultPict.detail,i=!0):this.defaultPict.preview&&(s=this.defaultPict.preview,i=!0)),i&&this.setCurrentImg(s,!0,!0)}},toggleMainPictPopup:function(){BX.hasClass(this.obBigSlider,"popup")?this.hideMainPictPopup():this.showMainPictPopup()},showMainPictPopup:function(){this.config.useMagnifier&&this.disableMagnifier(!1),BX.addClass(this.obBigSlider,"popup"),this.node.imageContainer.style.cursor="",document.body.style.overflow="hidden"},hideMainPictPopup:function(){this.config.useMagnifier&&this.disableMagnifier(!1),BX.removeClass(this.obBigSlider,"popup"),this.node.imageContainer.style.cursor="zoom-in",document.body.style.overflow=""},closeByEscape:function(i){27==(i=i||t.event).keyCode&&this.hideMainPictPopup()},startQuantityInterval:function(){var t=BX.proxy_context.id===this.visual.QUANTITY_DOWN_ID?BX.proxy(this.quantityDown,this):BX.proxy(this.quantityUp,this);this.quantityDelay=setTimeout(BX.delegate(function(){this.quantityTimer=setInterval(t,150)},this),300)},clearQuantityInterval:function(){clearTimeout(this.quantityDelay),clearInterval(this.quantityTimer)},quantityUp:function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&!this.isGift&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t+=this.stepQuantity,t=this.checkQuantityRange(t,"up"),this.checkQuantity&&t>this.maxQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t,this.setPrice())))},quantityDown:function(){var t=0,i=!0;0===this.errorCode&&this.config.showQuantity&&this.canBuy&&!this.isGift&&(t=this.isDblQuantity?parseFloat(this.obQuantity.value):parseInt(this.obQuantity.value,10),isNaN(t)||(t-=this.stepQuantity,(t=this.checkQuantityRange(t,"down"))<this.minQuantity&&(i=!1),i&&(this.isDblQuantity&&(t=Math.round(t*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=t,this.setPrice())))},quantityChange:function(){var t,i=0;0===this.errorCode&&this.config.showQuantity&&(this.canBuy?(i=this.isDblQuantity?parseFloat(this.obQuantity.value):Math.round(this.obQuantity.value),isNaN(i)?this.obQuantity.value=this.minQuantity:(i=this.checkQuantityRange(i),this.checkQuantity&&i>this.maxQuantity&&(i=this.maxQuantity),this.checkPriceRange(i),i<this.minQuantity?i=this.minQuantity:(i=(t=Math.round(Math.round(i*this.precisionFactor/this.stepQuantity)/this.precisionFactor)||1)<=1?this.stepQuantity:t*this.stepQuantity,i=Math.round(i*this.precisionFactor)/this.precisionFactor),this.obQuantity.value=i)):this.obQuantity.value=this.minQuantity,this.setPrice())},quantitySet:function(t){var i,s,e=this.offers[t],a=this.offers[this.offerNum];if(0===this.errorCode){if(this.canBuy=e.CAN_BUY,this.currentPriceMode=e.ITEM_PRICE_MODE,this.currentPrices=e.ITEM_PRICES,this.currentPriceSelected=e.ITEM_PRICE_SELECTED,this.currentQuantityRanges=e.ITEM_QUANTITY_RANGES,this.currentQuantityRangeSelected=e.ITEM_QUANTITY_RANGE_SELECTED,this.canBuy?(this.node.quantity&&BX.style(this.node.quantity,"display",""),this.obBasketActions&&BX.style(this.obBasketActions,"display",""),this.smallCardNodes.buyButton&&BX.style(this.smallCardNodes.buyButton,"display",""),this.smallCardNodes.addButton&&BX.style(this.smallCardNodes.addButton,"display",""),this.obNotAvail&&BX.style(this.obNotAvail,"display","none"),this.smallCardNodes.notAvailableButton&&BX.style(this.smallCardNodes.notAvailableButton,"display","none"),this.obSubscribe&&BX.style(this.obSubscribe,"display","none")):(this.node.quantity&&BX.style(this.node.quantity,"display","none"),this.obBasketActions&&BX.style(this.obBasketActions,"display","none"),this.smallCardNodes.buyButton&&BX.style(this.smallCardNodes.buyButton,"display","none"),this.smallCardNodes.addButton&&BX.style(this.smallCardNodes.addButton,"display","none"),this.obNotAvail&&BX.style(this.obNotAvail,"display",""),this.smallCardNodes.notAvailableButton&&BX.style(this.smallCardNodes.notAvailableButton,"display",""),this.obSubscribe&&("Y"===e.CATALOG_SUBSCRIBE?(BX.style(this.obSubscribe,"display",""),this.obSubscribe.setAttribute("data-item",e.ID),BX(this.visual.SUBSCRIBE_LINK+"_hidden").click()):BX.style(this.obSubscribe,"display","none"))),this.isDblQuantity=e.QUANTITY_FLOAT,this.checkQuantity=e.CHECK_QUANTITY,this.isDblQuantity?(this.stepQuantity=Math.round(parseFloat(e.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor,this.maxQuantity=parseFloat(e.MAX_QUANTITY),this.minQuantity="Q"===this.currentPriceMode?parseFloat(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity):(this.stepQuantity=parseInt(e.STEP_QUANTITY,10),this.maxQuantity=parseInt(e.MAX_QUANTITY,10),this.minQuantity="Q"===this.currentPriceMode?parseInt(this.currentPrices[this.currentPriceSelected].MIN_QUANTITY):this.stepQuantity),this.config.showQuantity){var r=a.ITEM_PRICES.length&&a.ITEM_PRICES[a.ITEM_PRICE_SELECTED]&&a.ITEM_PRICES[a.ITEM_PRICE_SELECTED].MIN_QUANTITY!=this.minQuantity;s=this.isDblQuantity?Math.round(parseFloat(a.STEP_QUANTITY)*this.precisionFactor)/this.precisionFactor!==this.stepQuantity||r||a.MEASURE!==e.MEASURE||this.checkQuantity&&parseFloat(a.MAX_QUANTITY)>this.maxQuantity&&parseFloat(this.obQuantity.value)>this.maxQuantity:parseInt(a.STEP_QUANTITY,10)!==this.stepQuantity||r||a.MEASURE!==e.MEASURE||this.checkQuantity&&parseInt(a.MAX_QUANTITY,10)>this.maxQuantity&&parseInt(this.obQuantity.value,10)>this.maxQuantity,this.obQuantity.disabled=!this.canBuy,s&&(this.obQuantity.value=this.minQuantity),this.obMeasure&&(e.MEASURE?BX.adjust(this.obMeasure,{html:e.MEASURE}):BX.adjust(this.obMeasure,{html:""}))}if(this.obQuantityLimit.all&&(this.checkQuantity&&0!=this.maxQuantity?("M"===this.config.showMaxQuantity?i=this.maxQuantity/this.stepQuantity>=this.config.relativeQuantityFactor?BX.message("RELATIVE_QUANTITY_MANY"):BX.message("RELATIVE_QUANTITY_FEW"):(i=this.maxQuantity,e.MEASURE&&(i+=" "+e.MEASURE)),BX.adjust(this.obQuantityLimit.value,{html:i}),BX.adjust(this.obQuantityLimit.all,{style:{display:""}})):(BX.adjust(this.obQuantityLimit.value,{html:""}),BX.adjust(this.obQuantityLimit.all,{style:{display:"none"}}))),this.config.usePriceRanges&&this.obPriceRanges)if("Q"===this.currentPriceMode&&e.PRICE_RANGES_HTML){var o=this.getEntity(this.obPriceRanges,"price-ranges-body"),n=this.getEntity(this.obPriceRanges,"price-ranges-ratio-header");o&&(o.innerHTML=e.PRICE_RANGES_HTML),n&&(n.innerHTML=e.PRICE_RANGES_RATIO_HTML),this.obPriceRanges.style.display=""}else this.obPriceRanges.style.display="none"}},selectOfferProp:function(){var t,i=0,s="",e=[],a=null,r=BX.proxy_context;if(r&&r.hasAttribute("data-treevalue")){if(BX.hasClass(r,"selected"))return;if("object"==typeof document.activeElement&&document.activeElement.blur(),e=(s=r.getAttribute("data-treevalue")).split("_"),this.searchOfferPropIndex(e[0],e[1]),(a=BX.findChildren(r.parentNode,{tagName:"li"},!1))&&a.length)for(i=0;i<a.length;i++)BX.removeClass(a[i],"selected");if(BX.addClass(r,"selected"),this.smallCardNodes.panel&&(t=this.smallCardNodes.panel.querySelector('[data-treevalue="'+s+'"]'))){for(a=this.smallCardNodes.panel.querySelectorAll('[data-sku-line="'+t.getAttribute("data-sku-line")+'"]'),i=0;i<a.length;i++)a[i].style.display="none";t.style.display=""}}},searchOfferPropIndex:function(t,i){var s,e,a="",r=!1,o=[],n=[],h=-1,l={},c=[];for(s=0;s<this.treeProps.length;s++)if(this.treeProps[s].ID===t){h=s;break}if(h>-1){for(s=0;s<h;s++)l[a="PROP_"+this.treeProps[s].ID]=this.selectedValues[a];for(l[a="PROP_"+this.treeProps[h].ID]=i,s=h+1;s<this.treeProps.length&&(a="PROP_"+this.treeProps[s].ID,r=this.getRowValues(l,a));s++){if(n=[],this.config.showAbsent)for(o=[],c=[],c=BX.clone(l,!0),e=0;e<r.length;e++)c[a]=r[e],n[n.length]=r[e],this.getCanBuy(c)&&(o[o.length]=r[e]);else o=r;this.selectedValues[a]&&BX.util.in_array(this.selectedValues[a],o)?l[a]=this.selectedValues[a]:this.config.showAbsent?l[a]=o.length?o[0]:n[0]:l[a]=o[0],this.updateRow(s,l[a],r,o)}this.selectedValues=l,this.changeInfo()}},updateRow:function(t,i,s,e){var a=0,r="",o=!1,n=null,h=this.getEntities(this.obTree,"sku-line-block");if(t>-1&&t<h.length){for(n=h[t].querySelectorAll("li"),a=0;a<n.length;a++)(o=(r=n[a].getAttribute("data-onevalue"))===i)?BX.addClass(n[a],"selected"):BX.removeClass(n[a],"selected"),BX.util.in_array(r,e)?BX.removeClass(n[a],"notallowed"):BX.addClass(n[a],"notallowed"),n[a].style.display=BX.util.in_array(r,s)?"":"none",o&&(h[t].style.display=0==r&&1==e.length?"none":"");if(this.smallCardNodes.panel)for(n=this.smallCardNodes.panel.querySelectorAll('[data-sku-line="'+t+'"]'),a=0;a<n.length;a++)o=(r=n[a].getAttribute("data-onevalue"))===i,n[a].style.display=o?"":"none",BX.util.in_array(r,e)?BX.removeClass(n[a],"notallowed"):BX.addClass(n[a],"notallowed"),o&&(n[a].style.display=0==r&&1==e.length?"none":"")}},getRowValues:function(t,i){var s=[],e=0,a=0,r=!1,o=!0;if(0===t.length){for(e=0;e<this.offers.length;e++)BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]);r=!0}else for(e=0;e<this.offers.length;e++){for(a in o=!0,t)if(t[a]!==this.offers[e].TREE[a]){o=!1;break}o&&(BX.util.in_array(this.offers[e].TREE[i],s)||(s[s.length]=this.offers[e].TREE[i]),r=!0)}return!!r&&s},getCanBuy:function(t){var i,s=0,e=!0,a=!1;for(i=0;i<this.offers.length;i++){for(s in e=!0,t)if(t[s]!==this.offers[i].TREE[s]){e=!1;break}if(e&&this.offers[i].CAN_BUY){a=!0;break}}return a},setCurrent:function(){var t,i=0,s="",e=!1,a=[],r={},o=[],n=this.offers[this.offerNum].TREE;for(t=0;t<this.treeProps.length&&(s="PROP_"+this.treeProps[t].ID,e=this.getRowValues(r,s));t++){if(BX.util.in_array(n[s],e)?r[s]=n[s]:(r[s]=e[0],this.offerNum=0),this.config.showAbsent)for(a=[],o=[],o=BX.clone(r,!0),i=0;i<e.length;i++)o[s]=e[i],this.getCanBuy(o)&&(a[a.length]=e[i]);else a=e;this.updateRow(t,r[s],e,a)}this.selectedValues=r,this.changeInfo()},changeInfo:function(){var t,i,s=-1,e=0,a=!0,r={currentId:this.offerNum>-1?this.offers[this.offerNum].ID:0,newId:0};for(t=0;t<this.offers.length;t++){for(e in a=!0,this.selectedValues)if(this.selectedValues[e]!==this.offers[t].TREE[e]){a=!1;break}if(a){s=t;break}}if(s>-1){for(s!=this.offerNum&&(this.isGift=!1),this.drawImages(this.offers[s].SLIDER),this.checkSliderControls(this.offers[s].SLIDER_COUNT),t=0;t<this.offers.length;t++)this.config.showOfferGroup&&this.offers[t].OFFER_GROUP&&(i=BX(this.visual.OFFER_GROUP+this.offers[t].ID))&&(i.style.display=t==s?"":"none"),this.slider.controls[t].ID?t===s?(this.product.slider=this.slider.controls[t],this.slider.controls[t].CONT&&BX.show(this.slider.controls[t].CONT)):this.slider.controls[t].CONT&&BX.hide(this.slider.controls[t].CONT):t===s&&(this.product.slider={});this.offers[s].SLIDER_COUNT>0?this.setMainPict(this.offers[s].ID,this.offers[s].SLIDER[0].ID,!0):this.setMainPictFromItem(s),this.offers[s].SLIDER_COUNT>1?this.initSlider():this.stopSlider(),this.config.showSkuProps&&(this.obSkuProps&&(this.offers[s].DISPLAY_PROPERTIES?BX.adjust(this.obSkuProps,{style:{display:""},html:this.offers[s].DISPLAY_PROPERTIES}):BX.adjust(this.obSkuProps,{style:{display:"none"},html:""})),this.obMainSkuProps&&(this.offers[s].DISPLAY_PROPERTIES_MAIN_BLOCK?BX.adjust(this.obMainSkuProps,{style:{display:""},html:this.offers[s].DISPLAY_PROPERTIES_MAIN_BLOCK}):BX.adjust(this.obMainSkuProps,{style:{display:"none"},html:""}))),this.quantitySet(s),this.setPrice(),this.setCompared(this.offers[s].COMPARED),this.offerNum=s,this.fixFontCheck(),this.setAnalyticsDataLayer("showDetail"),this.incViewedCounter(),r.newId=this.offers[this.offerNum].ID,BX.onCustomEvent("onCatalogStoreProductChange",[this.offers[this.offerNum].ID]),BX.onCustomEvent("onCatalogElementChangeOffer",[r]),r=null}},drawImages:function(t){if(this.node.imageContainer){var i,s,e=this.getEntities(this.node.imageContainer,"image");for(i in e)e.hasOwnProperty(i)&&BX.type.isDomNode(e[i])&&BX.remove(e[i]);for(i=0;i<t.length;i++)s=BX.create("IMG",{props:{src:t[i].SRC,alt:this.config.alt,title:this.config.title}}),0==i&&s.setAttribute("itemprop","image"),this.node.imageContainer.appendChild(BX.create("DIV",{attrs:{"data-entity":"image","data-id":t[i].ID},props:{className:"product-item-detail-slider-image"+(0==i?" active":"")},children:[s]}))}},restoreSticker:function(){this.previousStickerText?this.redrawSticker({text:this.previousStickerText}):this.hideSticker()},hideSticker:function(){BX.hide(BX(this.visual.STICKER_ID))},redrawSticker:function(t){var i=(t=t||{}).text||"",s=BX(this.visual.STICKER_ID);if(s){BX.show(s);var e=s.getAttribute("title");e&&e!=i&&(this.previousStickerText=e),BX.adjust(s,{text:i,attrs:{title:i}})}},checkQuantityRange:function(t,i){if(void 0===t||"Q"!==this.currentPriceMode)return t;var s,e,a,r,o,n,h=t=parseFloat(t);for(var l in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(l)){if(s=this.currentQuantityRanges[l],parseFloat(t)>=parseFloat(s.SORT_FROM)&&("INF"===s.SORT_TO||parseFloat(t)<=parseFloat(s.SORT_TO))){h=t;break}e=parseFloat(s.SORT_FROM)-t,a=Math.abs(e),r=parseFloat(s.SORT_TO)-t,o=Math.abs(r),(void 0===n||n>a)&&(void 0===i||"up"===i&&e>0||"down"===i&&e<0)&&(n=a,h=parseFloat(s.SORT_FROM)),(void 0===n||n>o)&&(void 0===i||"up"===i&&e>0||"down"===i&&e<0)&&(n=o,h=parseFloat(s.SORT_TO))}return h},checkPriceRange:function(t){if(void 0!==t&&"Q"===this.currentPriceMode){var i,s=!1;for(var e in this.currentQuantityRanges)if(this.currentQuantityRanges.hasOwnProperty(e)&&(i=this.currentQuantityRanges[e],parseFloat(t)>=parseFloat(i.SORT_FROM)&&("INF"===i.SORT_TO||parseFloat(t)<=parseFloat(i.SORT_TO)))){s=!0,this.currentQuantityRangeSelected=i.HASH;break}for(var a in!s&&(i=this.getMinPriceRange())&&(this.currentQuantityRangeSelected=i.HASH),this.currentPrices)if(this.currentPrices.hasOwnProperty(a)&&this.currentPrices[a].QUANTITY_HASH==this.currentQuantityRangeSelected){this.currentPriceSelected=a;break}}},getMinPriceRange:function(){var t;for(var i in this.currentQuantityRanges)this.currentQuantityRanges.hasOwnProperty(i)&&(!t||parseInt(this.currentQuantityRanges[i].SORT_FROM)<parseInt(t.SORT_FROM))&&(t=this.currentQuantityRanges[i]);return t},checkQuantityControls:function(){if(this.obQuantity){var t=this.checkQuantity&&parseFloat(this.obQuantity.value)+this.stepQuantity>this.maxQuantity,i=parseFloat(this.obQuantity.value)-this.stepQuantity<this.minQuantity;t?BX.addClass(this.obQuantityUp,"product-item-amount-field-btn-disabled"):BX.hasClass(this.obQuantityUp,"product-item-amount-field-btn-disabled")&&BX.removeClass(this.obQuantityUp,"product-item-amount-field-btn-disabled"),i?BX.addClass(this.obQuantityDown,"product-item-amount-field-btn-disabled"):BX.hasClass(this.obQuantityDown,"product-item-amount-field-btn-disabled")&&BX.removeClass(this.obQuantityDown,"product-item-amount-field-btn-disabled"),t&&i?this.obQuantity.setAttribute("disabled","disabled"):this.obQuantity.removeAttribute("disabled")}},setPrice:function(){var t,i="";this.obQuantity&&this.checkPriceRange(this.obQuantity.value),this.checkQuantityControls(),t=this.currentPrices[this.currentPriceSelected],this.isGift&&(t.PRICE=0,t.DISCOUNT=t.BASE_PRICE,t.PERCENT=100),this.obPrice.price&&(t?(BX.adjust(this.obPrice.price,{html:BX.Currency.currencyFormat(t.RATIO_PRICE,t.CURRENCY,!0)}),this.smallCardNodes.price&&BX.adjust(this.smallCardNodes.price,{html:BX.Currency.currencyFormat(t.RATIO_PRICE,t.CURRENCY,!0)})):(BX.adjust(this.obPrice.price,{html:""}),this.smallCardNodes.price&&BX.adjust(this.smallCardNodes.price,{html:""})),t&&t.RATIO_PRICE!==t.RATIO_BASE_PRICE?(this.config.showOldPrice&&(this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:""},html:BX.Currency.currencyFormat(t.RATIO_BASE_PRICE,t.CURRENCY,!0)}),this.smallCardNodes.oldPrice&&BX.adjust(this.smallCardNodes.oldPrice,{style:{display:""},html:BX.Currency.currencyFormat(t.RATIO_BASE_PRICE,t.CURRENCY,!0)}),this.obPrice.discount&&(i=(i=BX.message("ECONOMY_INFO_MESSAGE")).replace("#ECONOMY#",BX.Currency.currencyFormat(t.RATIO_DISCOUNT,t.CURRENCY,!0)),BX.adjust(this.obPrice.discount,{style:{display:""},html:i}))),this.config.showPercent&&this.obPrice.percent&&BX.adjust(this.obPrice.percent,{style:{display:""},html:-t.PERCENT+"%"})):(this.config.showOldPrice&&(this.obPrice.full&&BX.adjust(this.obPrice.full,{style:{display:"none"},html:""}),this.smallCardNodes.oldPrice&&BX.adjust(this.smallCardNodes.oldPrice,{style:{display:"none"},html:""}),this.obPrice.discount&&BX.adjust(this.obPrice.discount,{style:{display:"none"},html:""})),this.config.showPercent&&this.obPrice.percent&&BX.adjust(this.obPrice.percent,{style:{display:"none"},html:""})),this.obPrice.total&&(t&&this.obQuantity&&this.obQuantity.value!=this.stepQuantity?BX.adjust(this.obPrice.total,{html:BX.message("PRICE_TOTAL_PREFIX")+" <strong>"+BX.Currency.currencyFormat(t.PRICE*this.obQuantity.value,t.CURRENCY,!0)+"</strong>",style:{display:""}}):BX.adjust(this.obPrice.total,{html:"",style:{display:"none"}})))},compare:function(t){var i=this.obCompare.querySelector('[data-entity="compare-checkbox"]'),s=BX.getEventTarget(t),e=!0;i&&(e=s===i?i.checked:!i.checked);var a,r=e?this.compareData.compareUrl:this.compareData.compareDeleteUrl;if(r){switch(s!==i&&(BX.PreventDefault(t),this.setCompared(e)),this.productType){case 0:case 1:case 2:a=r.replace("#ID#",this.product.id.toString());break;case 3:a=r.replace("#ID#",this.offers[this.offerNum].ID)}BX.ajax({method:"POST",dataType:e?"json":"html",url:a+(-1!==a.indexOf("?")?"&":"?")+"ajax_action=Y",onsuccess:e?BX.proxy(this.compareResult,this):BX.proxy(this.compareDeleteResult,this)})}},compareResult:function(t){var s,e;this.obPopupWin&&this.obPopupWin.close(),BX.type.isPlainObject(t)&&(this.initPopupWindow(),this.offers.length>0&&(this.offers[this.offerNum].COMPARED="OK"===t.STATUS),"OK"===t.STATUS?(BX.onCustomEvent("OnCompareChange"),s='<div style="width: 100%; margin: 0; text-align: center;"><p>'+BX.message("COMPARE_MESSAGE_OK")+"</p></div>",e=this.config.showClosePopup?[new i({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)},style:{marginRight:"10px"}}),new i({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]:[new i({text:BX.message("BTN_MESSAGE_COMPARE_REDIRECT"),events:{click:BX.delegate(this.compareRedirect,this)}})]):(s='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(t.MESSAGE?t.MESSAGE:BX.message("COMPARE_UNKNOWN_ERROR"))+"</p></div>",e=[new i({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]),this.obPopupWin.setTitleBar(BX.message("COMPARE_TITLE")),this.obPopupWin.setContent(s),this.obPopupWin.setButtons(e),this.obPopupWin.show())},compareDeleteResult:function(){BX.onCustomEvent("OnCompareChange"),this.offers&&this.offers.length&&(this.offers[this.offerNum].COMPARED=!1)},setCompared:function(t){if(this.obCompare){var i=this.getEntity(this.obCompare,"compare-checkbox");i&&(i.checked=t)}},setCompareInfo:function(t){if(BX.type.isArray(t))for(var i in this.offers)this.offers.hasOwnProperty(i)&&(this.offers[i].COMPARED=BX.util.in_array(this.offers[i].ID,t))},compareRedirect:function(){this.compareData.comparePath?location.href=this.compareData.comparePath:this.obPopupWin.close()},checkDeletedCompare:function(t){switch(this.productType){case 0:case 1:case 2:this.product.id==t&&this.setCompared(!1);break;case 3:for(var i=this.offers.length;i--;)if(this.offers[i].ID==t){this.offers[i].COMPARED=!1,this.offerNum==i&&this.setCompared(!1);break}}},initBasketUrl:function(){switch(this.basketUrl="ADD"===this.basketMode?this.basketData.add_url:this.basketData.buy_url,this.productType){case 1:case 2:this.basketUrl=this.basketUrl.replace("#ID#",this.product.id.toString());break;case 3:this.basketUrl=this.basketUrl.replace("#ID#",this.offers[this.offerNum].ID)}this.basketParams={ajax_basket:"Y"},this.config.showQuantity&&(this.basketParams[this.basketData.quantity]=this.obQuantity.value),this.basketData.sku_props&&(this.basketParams[this.basketData.sku_props_var]=this.basketData.sku_props)},fillBasketProps:function(){if(this.visual.BASKET_PROP_DIV){var t=0,i=null,s=!1,e=null;if(this.basketData.useProps&&!this.basketData.emptyProps?this.obPopupWin&&this.obPopupWin.contentContainer&&(e=this.obPopupWin.contentContainer):e=BX(this.visual.BASKET_PROP_DIV),e){if((i=e.getElementsByTagName("select"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"select-one":this.basketParams[i[t].name]=i[t].value,s=!0}if((i=e.getElementsByTagName("input"))&&i.length)for(t=0;t<i.length;t++)if(!i[t].disabled)switch(i[t].type.toLowerCase()){case"hidden":this.basketParams[i[t].name]=i[t].value,s=!0;break;case"radio":i[t].checked&&(this.basketParams[i[t].name]=i[t].value,s=!0)}}s||(this.basketParams[this.basketData.props]=[],this.basketParams[this.basketData.props][0]=0)}},sendToBasket:function(){this.canBuy&&(this.initBasketUrl(),this.fillBasketProps(),BX.ajax({method:"POST",dataType:"json",url:this.basketUrl,data:this.basketParams,onsuccess:BX.proxy(this.basketResult,this)}))},add2Basket:function(){this.basketMode="ADD",this.basket()},buyBasket:function(){this.basketMode="BUY",this.basket()},basket:function(){var t="";if(this.canBuy)switch(this.productType){case 1:case 2:this.basketData.useProps&&!this.basketData.emptyProps?(this.initPopupWindow(),this.obPopupWin.setTitleBar(BX.message("TITLE_BASKET_PROPS")),BX(this.visual.BASKET_PROP_DIV)&&(t=BX(this.visual.BASKET_PROP_DIV).innerHTML),this.obPopupWin.setContent(t),this.obPopupWin.setButtons([new i({text:BX.message("BTN_SEND_PROPS"),events:{click:BX.delegate(this.sendToBasket,this)}})]),this.obPopupWin.show()):this.sendToBasket();break;case 3:this.sendToBasket()}},basketResult:function(t){var s,e,a;if(this.obPopupWin&&this.obPopupWin.close(),BX.type.isPlainObject(t))if("OK"===t.STATUS&&this.setAnalyticsDataLayer("addToCart"),"OK"===t.STATUS&&"BUY"===this.basketMode)this.basketRedirect();else{if(this.initPopupWindow(),"OK"===t.STATUS){switch(BX.onCustomEvent("OnBasketChange"),this.productType){case 1:case 2:a=this.product.pict.SRC;break;case 3:a=this.offers[this.offerNum].PREVIEW_PICTURE?this.offers[this.offerNum].PREVIEW_PICTURE.SRC:this.defaultPict.pict.SRC}s='<div style="width: 100%; margin: 0; text-align: center;"><img src="'+a+'" height="130" style="max-height:130px"><p>'+this.product.name+"</p></div>",e=this.config.showClosePopup?[new i({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)},style:{marginRight:"10px"}}),new i({text:BX.message("BTN_MESSAGE_CLOSE_POPUP"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})]:[new i({text:BX.message("BTN_MESSAGE_BASKET_REDIRECT"),events:{click:BX.delegate(this.basketRedirect,this)}})]}else s='<div style="width: 100%; margin: 0; text-align: center;"><p>'+(t.MESSAGE?t.MESSAGE:BX.message("BASKET_UNKNOWN_ERROR"))+"</p></div>",e=[new i({text:BX.message("BTN_MESSAGE_CLOSE"),events:{click:BX.delegate(this.obPopupWin.close,this.obPopupWin)}})];this.obPopupWin.setTitleBar("OK"===t.STATUS?BX.message("TITLE_SUCCESSFUL"):BX.message("TITLE_ERROR")),this.obPopupWin.setContent(s),this.obPopupWin.setButtons(e),this.obPopupWin.show()}},basketRedirect:function(){location.href=this.basketData.basketUrl?this.basketData.basketUrl:BX.message("BASKET_URL")},initPopupWindow:function(){this.obPopupWin||(this.obPopupWin=BX.PopupWindowManager.create("CatalogElementBasket_"+this.visual.ID,null,{autoHide:!1,offsetLeft:0,offsetTop:0,overlay:!0,closeByEsc:!0,titleBar:!0,closeIcon:!0,contentColor:"white",className:this.config.templateTheme?"bx-"+this.config.templateTheme:""}))},incViewedCounter:function(){if(this.currentIsSet&&!this.updateViewedCount){switch(this.productType){case 1:case 2:this.viewedCounter.params.PRODUCT_ID=this.product.id,this.viewedCounter.params.PARENT_ID=this.product.id;break;case 3:this.viewedCounter.params.PARENT_ID=this.product.id,this.viewedCounter.params.PRODUCT_ID=this.offers[this.offerNum].ID;break;default:return}this.viewedCounter.params.SITE_ID=BX.message("SITE_ID"),this.updateViewedCount=!0,BX.ajax.post(this.viewedCounter.path,this.viewedCounter.params,BX.delegate(function(){this.updateViewedCount=!1},this))}},allowViewedCount:function(t){this.currentIsSet=!0,t&&this.incViewedCounter()},fixFontCheck:function(){BX.type.isDomNode(this.obPrice.price)&&BX.FixFontSize&&BX.FixFontSize.init({objList:[{node:this.obPrice.price,maxFontSize:28,smallestValue:!1,scaleBy:this.obPrice.price.parentNode}],onAdaptiveResize:!0})}}}}(window);