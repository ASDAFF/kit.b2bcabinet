!function(){"use strict";window.JCCatalogTopComponent||(window.JCCatalogTopComponent=function(t){this.formPosting=!1,this.siteId=t.siteId||"",this.ajaxId=t.ajaxId||"",this.template=t.template||"",this.componentPath=t.componentPath||"",this.parameters=t.parameters||"",this.bigData=t.bigData||{enabled:!1},this.container=document.querySelector('[data-entity="'+t.container+'"]'),this.bigData.enabled&&BX.util.object_keys(this.bigData.rows).length>0&&(BX.cookie_prefix=this.bigData.js.cookiePrefix||"",BX.cookie_domain=this.bigData.js.cookieDomain||"",BX.current_server_time=this.bigData.js.serverTime,BX.ready(BX.delegate(this.bigDataLoad,this))),t.initiallyShowHeader&&BX.ready(BX.delegate(this.showHeader,this)),t.deferredLoad&&BX.ready(BX.delegate(this.deferredLoad,this))},window.JCCatalogTopComponent.prototype={bigDataLoad:function(){var t="https://analytics.bitrix.info/crecoms/v1_0/recoms.php",e=BX.ajax.prepareData(this.bigData.params);e&&(t+=(-1!==t.indexOf("?")?"&":"?")+e);var a=BX.delegate(function(t){this.sendRequest({action:"deferredLoad",bigData:"Y",items:t&&t.items||[],rid:t&&t.id,count:this.bigData.count,rowsRange:this.bigData.rowsRange,shownIds:this.bigData.shownIds})},this);BX.ajax({method:"GET",dataType:"json",url:t,timeout:3,onsuccess:a,onfailure:a})},deferredLoad:function(){this.sendRequest({action:"deferredLoad"})},sendRequest:function(t){var e={siteId:this.siteId,template:this.template,parameters:this.parameters};this.ajaxId&&(e.AJAX_ID=this.ajaxId),BX.ajax({url:this.componentPath+"/ajax.php"+(-1!==document.location.href.indexOf("clear_cache=Y")?"?clear_cache=Y":""),method:"POST",dataType:"json",timeout:60,data:BX.merge(e,t),onsuccess:BX.delegate(function(e){e&&e.JS&&BX.ajax.processScripts(BX.processHTML(e.JS).SCRIPT,!1,BX.delegate(function(){this.showAction(e,t)},this))},this)})},showAction:function(t,e){if(e)switch(e.action){case"deferredLoad":this.processDeferredLoadAction(t,"Y"===e.bigData)}},processDeferredLoadAction:function(t,e){if(t){var a=e?this.bigData.rows:{};this.processItems(t.items,BX.util.array_keys(a))}},processItems:function(t,e){if(t){var a,i,s,o=BX.processHTML(t,!1),n=BX.create("DIV");if(n.innerHTML=o.HTML,(a=n.querySelectorAll('[data-entity="items-row"]')).length){for(i in this.showHeader(!0),a)a.hasOwnProperty(i)&&(s=!!e&&this.container.querySelectorAll('[data-entity="items-row"]'),a[i].style.opacity=0,s&&BX.type.isDomNode(s[e[i]])?s[e[i]].parentNode.insertBefore(a[i],s[e[i]]):this.container.appendChild(a[i]));new BX.easing({duration:2e3,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){for(var e in a)a.hasOwnProperty(e)&&(a[e].style.opacity=t.opacity/100)},complete:function(){for(var t in a)a.hasOwnProperty(t)&&a[t].removeAttribute("style")}}).animate()}BX.ajax.processScripts(o.SCRIPT)}},showHeader:function(t){var e,a=BX.findParent(this.container,{attr:{"data-entity":"parent-container"}});a&&BX.type.isDomNode(a)&&(e=a.querySelector('[data-entity="header"'))&&"true"!=e.getAttribute("data-showed")&&(e.style.display="",t?new BX.easing({duration:2e3,start:{opacity:0},finish:{opacity:100},transition:BX.easing.makeEaseOut(BX.easing.transitions.quad),step:function(t){e.style.opacity=t.opacity/100},complete:function(){e.removeAttribute("style"),e.setAttribute("data-showed","true")}}).animate():e.style.opacity=100)}})}();